---
title: "Compress Your HTML Responses"
description: "Heroku doesn't compress your applications’s responses, you should."
layout: article
category: ruby
image:
  base: '2021/compress-your-rails-html-responses-on-heroku'
  alt: "Folded paper texture"
  credit: "JJ Ying"
  source: "https://unsplash.com/photos/WmnsGyaFnCQ"

---

There are multiple aspects to the performance of typical Rails applications: database queries, view render time, fragment caching, and more. There are also considerations for the front-end: image compression, Javascript, and CSS size.

We often use CDNs, compression, and minification for the assets (images, CSS, and JS) our applications use. However, many hosts ([including Heroku](https://devcenter.heroku.com/articles/compressing-http-messages-with-gzip)) do not compress the HTML that is generated by our applications by default.


## Ensure...

you compress the HTML output being sent from your app with gzip using `Rack::Deflater`.

### `config/application.rb`

```ruby
# ...
module DreamCoverage
  class Application < Rails::Application
    # ...
    config.middleware.use Rack::Deflater
    # ...
  end
end
```


## Why?

Compressing 'text-based' resources (i.e. the HTML or JSON your views generate) is one of Google‘s [standard performance recommendations](https://web.dev/uses-text-compression/).

In most cases, text-based responses compress _really_ well. I’ve seen compression of 20x on some of our more “HTML-repetative” `#index` actions at work, but 4x is typical on smaller pages. It makes an even bigger difference to performance on mobile, where network is more of a bottleneck.

You might find _spectacular_ savings if you're using something like [TailwindCSS](https://tailwindcss.com), [Bootstrap](https://getbootstrap.com), or another framework that result in repetitive class names in the HTML.

This (sadly!) doesn't absolve you of other performance work. These compression savings only occur after the page has rendered, so if your database queries are slow or your views take a long time to generate, you’ll still need to address those issues.


## Why not?

It is entirely possible you already serve your application from behind a CDN, like Fastly or Cloudflare, that automatically compresses your HTML & JSON responses. You won't need `Rack::Deflater` in these cases.

There will be a small increase in processing time for your user's devices as they decompress the response, but this is _vastly_ outweighed by the time savings made from sending the compressed response over the Internet.
